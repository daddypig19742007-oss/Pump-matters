name: Sync Smartsheet to repo

on: workflow_dispatch: schedule: - cron: '*/30 * * * *'

jobs: sync: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4

- name: Setup Node
    uses: actions/setup-node@v4
    with:
      node-version: '18'

  - name: Pull from Smartsheet
    run: npm run pull
    env:
      SMARTSHEET_TOKEN: ${{ secrets.SMARTSHEET_TOKEN }}
      SHEET_ID: ${{ secrets.SHEET_ID }}

  - name: Commit and push changes
    run: |
      git config user.name "github-actions[bot]"
      git config user.email "actions@github.com"
      git add data/*.csv data/measurements/*.json || true
      if git diff --cached --quiet; then
        echo "No changes"
      else
        git commit -m "Sync Smartsheet"
        git push
      fi
